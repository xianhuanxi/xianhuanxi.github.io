<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Xitoys.cn - å·¥ä¸šçº§ç‰©ç†äº¤äº’</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body, html { width: 100%; height: 100%; overflow: hidden; background: #ff5f8d; position: fixed; }

        /* èƒŒæ™¯å±‚ï¼šç¡®ä¿æ¯”ä¾‹æ­£ç¡® */
        .main-viewport {
            position: absolute; width: 100vw; height: 100vh;
            background: radial-gradient(circle at 50% 50%, #ff85ad 0%, #ff5f8d 100%);
            z-index: 1; overflow: hidden;
        }

        /* å·¨å¤§å“ç‰Œ Logo */
        .brand-title {
            position: absolute; top: 12%; width: 100%; text-align: center;
            z-index: 10; pointer-events: none;
        }
        .brand-title h1 {
            color: white; font-size: 22vw; font-weight: 900; font-style: italic;
            text-shadow: 0 10px 40px rgba(0,0,0,0.2); line-height: 1;
        }

        /* æ°”æ³¡æ ·å¼ï¼šå¼ºåˆ¶åœ†å½¢æ¯”ä¾‹ */
        .b-node {
            position: absolute; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; color: white;
            text-decoration: none; font-weight: bold;
            border: 2px solid rgba(255,255,255,0.5);
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(255,255,255,0.1) 40%, rgba(135,206,250,0.3) 100%);
            box-shadow: inset -10px -10px 25px rgba(255,255,255,0.3), 0 15px 45px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
            z-index: 50; touch-action: none; will-change: transform;
            aspect-ratio: 1/1; /* å¼ºåˆ¶ä¿æŒæ­£åœ†ï¼Œè§£å†³å‹æ‰é—®é¢˜ */
        }

        /* å³ä¸‹è§’å·¨å¤§è´­ç‰©çƒ */
        .shop-giant {
            width: 340px !important; height: 340px !important; font-size: 34px;
            background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.85), rgba(255,180,0,0.3) 60%, rgba(255,0,80,0.5) 100%);
            position: fixed !important; right: -60px; bottom: -60px;
            z-index: 100; border: 4px solid rgba(255,255,255,0.6);
        }

        #line-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 20; pointer-events: none; }
        .b-txt { text-shadow: 0 2px 10px rgba(0,0,0,0.3); text-align: center; padding: 10px; font-size: 18px; }
    </style>
</head>
<body>

<div class="main-viewport">
    <div class="brand-title"><h1>Xitoys</h1></div>
    <canvas id="line-canvas"></canvas>
    <div id="bubbles-layer"></div>
</div>

<script>
    const canvas = document.getElementById('line-canvas');
    const ctx = canvas.getContext('2d');
    const layer = document.getElementById('bubbles-layer');

    let w, h, bubbles = [];
    let dragTarget = null;

    const dataSet = [
        { label: 'æ¬¢å–œæ•…äº‹', r: 75 },
        { label: 'ä¸¤æ€§ç§‘æ™®', r: 85 },
        { label: 'è§†é¢‘é¢‘é“', r: 70 },
        { label: 'æˆ‘è¦æŠ•èµ„', r: 65 },
        { label: 'ğŸ›’ åœ¨çº¿è´­ç‰©', r: 170, main: true }
    ];

    function init() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
        layer.innerHTML = '';
        bubbles = [];

        dataSet.forEach((d, i) => {
            const el = document.createElement('div');
            el.className = 'b-node' + (d.main ? ' shop-giant' : '');
            el.innerHTML = `<span class="b-txt">${d.label}</span>`;
            layer.appendChild(el);

            // åˆå§‹åˆ†å¸ƒé€»è¾‘ï¼šé˜²æ­¢é‡å èµ·æ­¥
            let startX = d.main ? w - 240 : (w * (0.2 + (i%2)*0.5));
            let startY = d.main ? h - 240 : (h * (0.3 + Math.floor(i/2)*0.4));

            const b = {
                el, r: d.r, x: startX, y: startY,
                vx: d.main ? 0 : (Math.random() - 0.5) * 4,
                vy: d.main ? 0 : (Math.random() - 0.5) * 4,
                isMain: d.main || false,
                isDragging: false
            };

            if (!d.main) {
                el.addEventListener('touchstart', (e) => {
                    dragTarget = b;
                    b.isDragging = true;
                }, {passive: true});
            }
            bubbles.push(b);
        });
    }

    // åˆšä½“ç¢°æ’ç®—æ³•ï¼šè§£å†³é‡å é—®é¢˜çš„å…³é”®
    function physicsEngine() {
        for (let i = 0; i < bubbles.length; i++) {
            let b1 = bubbles[i];
            
            // è¾¹ç•Œæ£€æŸ¥ï¼šå¢™å£åå¼¹
            if (!b1.isDragging && !b1.isMain) {
                if (b1.x < b1.r) { b1.x = b1.r; b1.vx *= -1; }
                if (b1.x > w - b1.r) { b1.x = w - b1.r; b1.vx *= -1; }
                if (b1.y < b1.r + 100) { b1.y = b1.r + 100; b1.vy *= -1; }
                if (b1.y > h - b1.r) { b1.y = h - b1.r; b1.vy *= -1; }
            }

            for (let j = i + 1; j < bubbles.length; j++) {
                let b2 = bubbles[j];
                const dx = b2.x - b1.x;
                const dy = b2.y - b1.y;
                const dist = Math.hypot(dx, dy);
                const min = b1.r + b2.r;

                if (dist < min) {
                    // 1. å¼ºåˆ¶é¿è®©ä½ç§» (Static Resolution)
                    const angle = Math.atan2(dy, dx);
                    const push = (min - dist) / 2;
                    
                    if (!b1.isDragging && !b1.isMain) {
                        b1.x -= Math.cos(angle) * push;
                        b1.y -= Math.sin(angle) * push;
                        b1.vx *= -0.8; // ç¢°æ’æŸè€—
                    }
                    if (!b2.isDragging && !b2.isMain) {
                        b2.x += Math.cos(angle) * push;
                        b2.y += Math.sin(angle) * push;
                        b2.vx *= -0.8;
                    }
                }
            }
        }
    }

    function render() {
        ctx.clearRect(0, 0, w, h);
        bubbles.forEach((b, i) => {
            if (!b.isDragging && !b.isMain) {
                b.x += b.vx; b.y += b.vy;
            }
            // ä½¿ç”¨ translate3d æé«˜æ¸²æŸ“æ€§èƒ½ï¼Œé˜²æ­¢æŠ–åŠ¨
            b.el.style.transform = `translate3d(${b.x - b.r}px, ${b.y - b.r}px, 0)`;

            // ç»˜åˆ¶ç”µæµè¿çº¿
            bubbles.slice(i + 1).forEach(b2 => {
                const dist = Math.hypot(b1.x - b2.x, b1.y - b2.y); // æ³¨æ„è¿™é‡Œb1éœ€å¯¹åº”å½“å‰b
                drawLightning(b, b2);
            });
        });
    }

    function drawLightning(b1, b2) {
        const d = Math.hypot(b1.x - b2.x, b1.y - b2.y);
        if (d < 400) {
            ctx.beginPath();
            ctx.moveTo(b1.x, b1.y);
            for(let k=1; k<6; k++) {
                ctx.lineTo(b1.x + (b2.x-b1.x)*k/6 + (Math.random()-0.5)*45, 
                           b1.y + (b2.y-b1.y)*k/6 + (Math.random()-0.5)*45);
            }
            ctx.lineTo(b2.x, b2.y);
            ctx.strokeStyle = `rgba(255, 255, 255, ${0.6 * (1-d/400)})`;
            ctx.lineWidth = 2 * (1-d/400);
            ctx.stroke();
        }
    }

    window.addEventListener('touchmove', (e) => {
        if (dragTarget) {
            const touch = e.touches[0];
            dragTarget.x = touch.clientX;
            dragTarget.y = touch.clientY;
        }
    }, {passive: false});

    window.addEventListener('touchend', () => {
        if (dragTarget) dragTarget.isDragging = false;
        dragTarget = null;
    });

    function mainLoop() {
        physicsEngine();
        render();
        requestAnimationFrame(mainLoop);
    }

    window.addEventListener('resize', init);
    init();
    mainLoop();
</script>
</body>
</html>
